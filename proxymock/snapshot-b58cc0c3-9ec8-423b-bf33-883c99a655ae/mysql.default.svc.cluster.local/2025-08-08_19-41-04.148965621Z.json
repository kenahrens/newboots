{
  "msgType": "rrpair",
  "resource": "newboots-server",
  "ts": "2025-08-08T19:41:04.148965621Z",
  "l7protocol": "mysql",
  "duration": 1,
  "tags": {
    "captureMode": "proxy",
    "k8sAppLabel": "newboots-server",
    "k8sAppPodName": "newboots-server-55d8b59f9-btw5x",
    "k8sAppPodNamespace": "default",
    "k8sClusterName": "colimaken",
    "proxyId": "newboots-server-55d8b59f9-btw5x",
    "proxyLocation": "out",
    "proxyProtocol": "",
    "proxyType": "transparent",
    "proxyVersion": "v2.3.661",
    "sequence": "173",
    "source": "goproxy",
    "trimmed": ""
  },
  "uuid": "lzVShbhgTrmTB02lVO5z/g==",
  "direction": "OUT",
  "cluster": "colimaken",
  "namespace": "default",
  "service": "newboots-server",
  "tech": "MySQL",
  "network_address": "mysql.default.svc.cluster.local:3306",
  "command": "Query",
  "location": "N/A",
  "status": "OK",
  "mysql": {
    "request": {
      "query": {
        "query": "select p1_0.id,p1_0.average_lifespan,p1_0.breed,p1_0.description,p1_0.size_category,p1_0.species from pets p1_0 where upper(p1_0.species)=upper('dog')"
      }
    },
    "response": {
      "textResultsets": {
        "resultsets": [
          {
            "columns": [
              {
                "catalog": "def",
                "schema": "newboots",
                "table": "p1_0",
                "physicalTable": "pets",
                "name": "id",
                "physicalName": "id",
                "numFixedLengthFields": 12,
                "charset": "MYSQL_CHARSET_BINARY",
                "maxColumnLength": 20,
                "type": "MYSQL_FIELD_TYPE_LONGLONG",
                "flags": [
                  "FLAG_AUTO_INCREMENT",
                  "FLAG_FIELD_FLAGS_STORAGE_MEDIA",
                  "FLAG_PRI_KEY",
                  "FLAG_PART_KEY",
                  "FLAG_GROUP",
                  "FLAG_NOT_NULL"
                ]
              },
              {
                "catalog": "def",
                "schema": "newboots",
                "table": "p1_0",
                "physicalTable": "pets",
                "name": "average_lifespan",
                "physicalName": "average_lifespan",
                "numFixedLengthFields": 12,
                "charset": "MYSQL_CHARSET_BINARY",
                "maxColumnLength": 11,
                "type": "MYSQL_FIELD_TYPE_LONG"
              },
              {
                "catalog": "def",
                "schema": "newboots",
                "table": "p1_0",
                "physicalTable": "pets",
                "name": "breed",
                "physicalName": "breed",
                "numFixedLengthFields": 12,
                "charset": "MYSQL_CHARSET_UTF8MB4_0900_AI_CI",
                "maxColumnLength": 1020,
                "type": "MYSQL_FIELD_TYPE_VAR_STRING",
                "flags": [
                  "FLAG_NOT_NULL",
                  "FLAG_NO_DEFAULT_VALUE",
                  "FLAG_GROUP"
                ]
              },
              {
                "catalog": "def",
                "schema": "newboots",
                "table": "p1_0",
                "physicalTable": "pets",
                "name": "description",
                "physicalName": "description",
                "numFixedLengthFields": 12,
                "charset": "MYSQL_CHARSET_UTF8MB4_0900_AI_CI",
                "maxColumnLength": 1020,
                "type": "MYSQL_FIELD_TYPE_VAR_STRING"
              },
              {
                "catalog": "def",
                "schema": "newboots",
                "table": "p1_0",
                "physicalTable": "pets",
                "name": "size_category",
                "physicalName": "size_category",
                "numFixedLengthFields": 12,
                "charset": "MYSQL_CHARSET_UTF8MB4_0900_AI_CI",
                "maxColumnLength": 1020,
                "type": "MYSQL_FIELD_TYPE_VAR_STRING"
              },
              {
                "catalog": "def",
                "schema": "newboots",
                "table": "p1_0",
                "physicalTable": "pets",
                "name": "species",
                "physicalName": "species",
                "numFixedLengthFields": 12,
                "charset": "MYSQL_CHARSET_UTF8MB4_0900_AI_CI",
                "maxColumnLength": 1020,
                "type": "MYSQL_FIELD_TYPE_VAR_STRING",
                "flags": [
                  "FLAG_NO_DEFAULT_VALUE",
                  "FLAG_GROUP",
                  "FLAG_NOT_NULL"
                ]
              }
            ],
            "rows": [
              {
                "fields": [
                  {
                    "asString": "1"
                  },
                  {
                    "asString": "12"
                  },
                  {
                    "asString": "Golden Retriever"
                  },
                  {
                    "asString": "Friendly and intelligent family dog"
                  },
                  {
                    "asString": "Large"
                  },
                  {
                    "asString": "Dog"
                  }
                ]
              },
              {
                "fields": [
                  {
                    "asString": "2"
                  },
                  {
                    "asString": "12"
                  },
                  {
                    "asString": "Labrador Retriever"
                  },
                  {
                    "asString": "Popular family companion and working dog"
                  },
                  {
                    "asString": "Large"
                  },
                  {
                    "asString": "Dog"
                  }
                ]
              },
              {
                "fields": [
                  {
                    "asString": "3"
                  },
                  {
                    "asString": "10"
                  },
                  {
                    "asString": "German Shepherd"
                  },
                  {
                    "asString": "Loyal and protective working dog"
                  },
                  {
                    "asString": "Large"
                  },
                  {
                    "asString": "Dog"
                  }
                ]
              }
            ]
          }
        ]
      }
    },
    "handshake": {
      "request": {
        "serverVersion": "8.0.43",
        "threadID": 138,
        "capabilities": [
          "MYSQL_CAPABILITY_DEPRECATE_EOF",
          "MYSQL_CAPABILITY_REMEMBER_OPTIONS",
          "MYSQL_CAPABILITY_MULTI_RESULTS",
          "MYSQL_CAPABILITY_SSL_VERIFY_SERVER_CERT",
          "MYSQL_CAPABILITY_NO_SCHEMA",
          "MYSQL_CAPABILITY_ODBC",
          "MYSQL_CAPABILITY_PROTOCOL_41",
          "MYSQL_CAPABILITY_CONNECT_ATTRS",
          "MYSQL_CAPABILITY_SESSION_TRACK",
          "MYSQL_CAPABILITY_QUERY_ATTRIBUTES",
          "MYSQL_CAPABILITY_LONG_FLAG",
          "MYSQL_CAPABILITY_SSL",
          "MYSQL_CAPABILITY_OPTIONAL_RESULTSET_METADATA",
          "MYSQL_CAPABILITY_MULTI_FACTOR_AUTHENTICATION",
          "MYSQL_CAPABILITY_LONG_PASSWORD",
          "MYSQL_CAPABILITY_IGNORE_SPACE",
          "MYSQL_CAPABILITY_TRANSACTIONS",
          "MYSQL_CAPABILITY_FOUND_ROWS",
          "MYSQL_CAPABILITY_CONNECT_WITH_DB",
          "MYSQL_CAPABILITY_LOCAL_FILES",
          "MYSQL_CAPABILITY_RESERVED2",
          "MYSQL_CAPABILITY_MULTI_STATEMENTS",
          "MYSQL_CAPABILITY_PS_MULTI_RESULTS",
          "MYSQL_CAPABILITY_CAN_HANDLE_EXPIRED_PASSWORDS",
          "MYSQL_CAPABILITY_ZSTD_COMPRESSION_ALGORITHM",
          "MYSQL_CAPABILITY_INTERACTIVE",
          "MYSQL_CAPABILITY_RESERVED",
          "MYSQL_CAPABILITY_PLUGIN_AUTH",
          "MYSQL_CAPABILITY_COMPRESS",
          "MYSQL_CAPABILITY_IGNORE_SIGPIPE",
          "MYSQL_CAPABILITY_PLUGIN_AUTH_LENENC_CLIENT_DATA"
        ],
        "serverStatus": [
          "MYSQL_SERVER_STATUS_AUTOCOMMIT"
        ],
        "charset": "MYSQL_CHARSET_UTF8MB4_0900_AI_CI",
        "authPlugin": "mysql_native_password"
      },
      "response": {
        "capabilities": [
          "MYSQL_CAPABILITY_PROTOCOL_41",
          "MYSQL_CAPABILITY_CONNECT_ATTRS",
          "MYSQL_CAPABILITY_QUERY_ATTRIBUTES",
          "MYSQL_CAPABILITY_LONG_FLAG",
          "MYSQL_CAPABILITY_MULTI_FACTOR_AUTHENTICATION",
          "MYSQL_CAPABILITY_LONG_PASSWORD",
          "MYSQL_CAPABILITY_TRANSACTIONS",
          "MYSQL_CAPABILITY_FOUND_ROWS",
          "MYSQL_CAPABILITY_CONNECT_WITH_DB",
          "MYSQL_CAPABILITY_RESERVED2",
          "MYSQL_CAPABILITY_PS_MULTI_RESULTS",
          "MYSQL_CAPABILITY_PLUGIN_AUTH",
          "MYSQL_CAPABILITY_PLUGIN_AUTH_LENENC_CLIENT_DATA",
          "MYSQL_CAPABILITY_DEPRECATE_EOF",
          "MYSQL_CAPABILITY_MULTI_RESULTS"
        ],
        "maxPacketSize": 16777215,
        "charset": "MYSQL_CHARSET_UTF8MB4_0900_AI_CI",
        "username": "newboots",
        "database": "newboots",
        "authPlugin": "mysql_native_password",
        "connectAttrs": {
          "_client_license": "GPL",
          "_client_name": "MySQL Connector/J",
          "_client_version": "8.0.33",
          "_runtime_vendor": "Amazon.com Inc.",
          "_runtime_version": "17.0.16"
        }
      }
    }
  },
  "tokenList": {
    "SQL:SELECT p1_0.id, p1_0.average_lifespan, p1_0.breed, p1_0.description, p1_0.size_category, p1_0.species FROM pets p1_0 WHERE upper(p1_0.species) = upper('dog')": {
      "id": "SQL:SELECT p1_0.id, p1_0.average_lifespan, p1_0.breed, p1_0.description, p1_0.size_category, p1_0.species FROM pets p1_0 WHERE upper(p1_0.species) = upper('dog')",
      "tokens": [
        {
          "uuid": "lzVShbhgTrmTB02lVO5z/g==",
          "token": {
            "location": "mysql.request.query.query",
            "pattern": "DATA_PATTERN_SQL",
            "replacementValue": "U0VMRUNUIHAxXzAuaWQsIHAxXzAuYXZlcmFnZV9saWZlc3BhbiwgcDFfMC5icmVlZCwgcDFfMC5kZXNjcmlwdGlvbiwgcDFfMC5zaXplX2NhdGVnb3J5LCBwMV8wLnNwZWNpZXMgRlJPTSBwZXRzIHAxXzAgV0hFUkUgdXBwZXIocDFfMC5zcGVjaWVzKSA9IHVwcGVyKCdkb2cnKQ=="
          }
        }
      ]
    }
  },
  "signature": {
    "mysql:command": "UXVlcnk=",
    "mysql:phase": "TVlTUUxfUEhBU0VfQ09NTUFORA==",
    "mysql:query": "U0VMRUNUIHAxXzAuaWQsIHAxXzAuYXZlcmFnZV9saWZlc3BhbiwgcDFfMC5icmVlZCwgcDFfMC5kZXNjcmlwdGlvbiwgcDFfMC5zaXplX2NhdGVnb3J5LCBwMV8wLnNwZWNpZXMgRlJPTSBwZXRzIHAxXzAgV0hFUkUgdXBwZXIocDFfMC5zcGVjaWVzKSA9IHVwcGVyKCdkb2cnKQ=="
  },
  "events": [
    {
      "uuid": "fde0b271-58da-49ac-8654-150cbafed67d",
      "ts": "2025-08-08T19:41:04.149970165Z",
      "source": "",
      "operation": "transform",
      "message": "transform chain failed: failed to mutate: failed to extract with *extractor.HTTPReqHeader: incorrect protocol type"
    }
  ],
  "netinfo": {
    "id": "1",
    "startTime": "2025-08-08T19:40:22.427053524Z",
    "downstream": {
      "established": "2025-08-08T19:40:22.426404690Z",
      "ipAddress": "10.42.0.61",
      "port": 57764,
      "bytesSent": "8442"
    },
    "upstream": {
      "established": "2025-08-08T19:40:22.426711774Z",
      "ipAddress": "10.43.99.202",
      "port": 3306,
      "hostname": "mysql.default.svc.cluster.local",
      "bytesSent": "9389"
    }
  },
  "mutableSignature": {
    "mysql:command": "Query",
    "mysql:phase": "MYSQL_PHASE_COMMAND",
    "mysql:query": "SELECT p1_0.id, p1_0.average_lifespan, p1_0.breed, p1_0.description, p1_0.size_category, p1_0.species FROM pets p1_0 WHERE upper(p1_0.species) = upper('dog')"
  }
}