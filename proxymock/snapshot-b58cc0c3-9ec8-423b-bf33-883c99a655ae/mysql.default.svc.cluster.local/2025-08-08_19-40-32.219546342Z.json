{
  "msgType": "rrpair",
  "resource": "newboots-server",
  "ts": "2025-08-08T19:40:32.219546342Z",
  "l7protocol": "mysql",
  "duration": 1,
  "tags": {
    "captureMode": "proxy",
    "k8sAppLabel": "newboots-server",
    "k8sAppPodName": "newboots-server-55d8b59f9-btw5x",
    "k8sAppPodNamespace": "default",
    "k8sClusterName": "colimaken",
    "proxyId": "newboots-server-55d8b59f9-btw5x",
    "proxyLocation": "out",
    "proxyProtocol": "",
    "proxyType": "transparent",
    "proxyVersion": "v2.3.661",
    "sequence": "126",
    "source": "goproxy",
    "trimmed": ""
  },
  "uuid": "FHSrWlOVRfen4Sb6ZYooVA==",
  "direction": "OUT",
  "cluster": "colimaken",
  "namespace": "default",
  "service": "newboots-server",
  "tech": "MySQL",
  "network_address": "mysql.default.svc.cluster.local:3306",
  "command": "Query",
  "location": "N/A",
  "status": "OK",
  "mysql": {
    "request": {
      "query": {
        "query": "select count(*) from pets p1_0"
      }
    },
    "response": {
      "textResultsets": {
        "resultsets": [
          {
            "columns": [
              {
                "catalog": "def",
                "name": "count(*)",
                "numFixedLengthFields": 12,
                "charset": "MYSQL_CHARSET_BINARY",
                "maxColumnLength": 21,
                "type": "MYSQL_FIELD_TYPE_LONGLONG",
                "flags": [
                  "FLAG_BINARY",
                  "FLAG_GROUP",
                  "FLAG_NOT_NULL"
                ]
              }
            ],
            "rows": [
              {
                "fields": [
                  {
                    "asString": "12"
                  }
                ]
              }
            ]
          }
        ]
      }
    },
    "handshake": {
      "request": {
        "serverVersion": "8.0.43",
        "threadID": 138,
        "capabilities": [
          "MYSQL_CAPABILITY_DEPRECATE_EOF",
          "MYSQL_CAPABILITY_REMEMBER_OPTIONS",
          "MYSQL_CAPABILITY_MULTI_RESULTS",
          "MYSQL_CAPABILITY_SSL_VERIFY_SERVER_CERT",
          "MYSQL_CAPABILITY_NO_SCHEMA",
          "MYSQL_CAPABILITY_ODBC",
          "MYSQL_CAPABILITY_PROTOCOL_41",
          "MYSQL_CAPABILITY_CONNECT_ATTRS",
          "MYSQL_CAPABILITY_SESSION_TRACK",
          "MYSQL_CAPABILITY_QUERY_ATTRIBUTES",
          "MYSQL_CAPABILITY_LONG_FLAG",
          "MYSQL_CAPABILITY_SSL",
          "MYSQL_CAPABILITY_OPTIONAL_RESULTSET_METADATA",
          "MYSQL_CAPABILITY_MULTI_FACTOR_AUTHENTICATION",
          "MYSQL_CAPABILITY_LONG_PASSWORD",
          "MYSQL_CAPABILITY_IGNORE_SPACE",
          "MYSQL_CAPABILITY_TRANSACTIONS",
          "MYSQL_CAPABILITY_FOUND_ROWS",
          "MYSQL_CAPABILITY_CONNECT_WITH_DB",
          "MYSQL_CAPABILITY_LOCAL_FILES",
          "MYSQL_CAPABILITY_RESERVED2",
          "MYSQL_CAPABILITY_MULTI_STATEMENTS",
          "MYSQL_CAPABILITY_PS_MULTI_RESULTS",
          "MYSQL_CAPABILITY_CAN_HANDLE_EXPIRED_PASSWORDS",
          "MYSQL_CAPABILITY_ZSTD_COMPRESSION_ALGORITHM",
          "MYSQL_CAPABILITY_INTERACTIVE",
          "MYSQL_CAPABILITY_RESERVED",
          "MYSQL_CAPABILITY_PLUGIN_AUTH",
          "MYSQL_CAPABILITY_COMPRESS",
          "MYSQL_CAPABILITY_IGNORE_SIGPIPE",
          "MYSQL_CAPABILITY_PLUGIN_AUTH_LENENC_CLIENT_DATA"
        ],
        "serverStatus": [
          "MYSQL_SERVER_STATUS_AUTOCOMMIT"
        ],
        "charset": "MYSQL_CHARSET_UTF8MB4_0900_AI_CI",
        "authPlugin": "mysql_native_password"
      },
      "response": {
        "capabilities": [
          "MYSQL_CAPABILITY_PROTOCOL_41",
          "MYSQL_CAPABILITY_CONNECT_ATTRS",
          "MYSQL_CAPABILITY_QUERY_ATTRIBUTES",
          "MYSQL_CAPABILITY_LONG_FLAG",
          "MYSQL_CAPABILITY_MULTI_FACTOR_AUTHENTICATION",
          "MYSQL_CAPABILITY_LONG_PASSWORD",
          "MYSQL_CAPABILITY_TRANSACTIONS",
          "MYSQL_CAPABILITY_FOUND_ROWS",
          "MYSQL_CAPABILITY_CONNECT_WITH_DB",
          "MYSQL_CAPABILITY_RESERVED2",
          "MYSQL_CAPABILITY_PS_MULTI_RESULTS",
          "MYSQL_CAPABILITY_PLUGIN_AUTH",
          "MYSQL_CAPABILITY_PLUGIN_AUTH_LENENC_CLIENT_DATA",
          "MYSQL_CAPABILITY_DEPRECATE_EOF",
          "MYSQL_CAPABILITY_MULTI_RESULTS"
        ],
        "maxPacketSize": 16777215,
        "charset": "MYSQL_CHARSET_UTF8MB4_0900_AI_CI",
        "username": "newboots",
        "database": "newboots",
        "authPlugin": "mysql_native_password",
        "connectAttrs": {
          "_client_license": "GPL",
          "_client_name": "MySQL Connector/J",
          "_client_version": "8.0.33",
          "_runtime_vendor": "Amazon.com Inc.",
          "_runtime_version": "17.0.16"
        }
      }
    }
  },
  "tokenList": {
    "SQL:SELECT count(*) FROM pets p1_0": {
      "id": "SQL:SELECT count(*) FROM pets p1_0",
      "tokens": [
        {
          "uuid": "FHSrWlOVRfen4Sb6ZYooVA==",
          "token": {
            "location": "mysql.request.query.query",
            "pattern": "DATA_PATTERN_SQL",
            "replacementValue": "U0VMRUNUIGNvdW50KCopIEZST00gcGV0cyBwMV8w"
          }
        }
      ]
    }
  },
  "signature": {
    "mysql:command": "UXVlcnk=",
    "mysql:phase": "TVlTUUxfUEhBU0VfQ09NTUFORA==",
    "mysql:query": "U0VMRUNUIGNvdW50KCopIEZST00gcGV0cyBwMV8w"
  },
  "events": [
    {
      "uuid": "e9e97b06-9791-4bd5-9d51-05df7c0e2a5f",
      "ts": "2025-08-08T19:40:32.220545261Z",
      "source": "",
      "operation": "transform",
      "message": "transform chain failed: failed to mutate: failed to extract with *extractor.HTTPReqHeader: incorrect protocol type"
    }
  ],
  "netinfo": {
    "id": "1",
    "startTime": "2025-08-08T19:40:22.427053524Z",
    "downstream": {
      "established": "2025-08-08T19:40:22.426404690Z",
      "ipAddress": "10.42.0.61",
      "port": 57764,
      "bytesSent": "7830"
    },
    "upstream": {
      "established": "2025-08-08T19:40:22.426711774Z",
      "ipAddress": "10.43.99.202",
      "port": 3306,
      "hostname": "mysql.default.svc.cluster.local",
      "bytesSent": "7272"
    }
  },
  "mutableSignature": {
    "mysql:command": "Query",
    "mysql:phase": "MYSQL_PHASE_COMMAND",
    "mysql:query": "SELECT count(*) FROM pets p1_0"
  }
}